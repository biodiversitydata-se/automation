{"version":3,"sources":["app/js/autocomplete-conf.js","app/js/i18next-config.js","app/js/index-auth.js","app/js/init.js","app/js/mante.js","app/js/settings.js","app/js/stats.js"],"names":["settings","require","bieService","services","url","window","BC_CONF","autocompleteURL","i18n","jqueryI18next","backend","lngDetector","cache","Url","Cookies","backOpts","loadPath","crossDomain","currentUrl","laSessionCookie","i18nOpts","fallbackLng","zh","default","sendMissingTo","interpolation","escapeValue","formatSeparator","format","f","value","lng","toUpperCase","Date","moment","Intl","NumberFormat","whitelist","enabledLangs","load","debug","ns","defaultNS","saveMissing","saveMissingTo","keySeparator","nsSeparator","pluralSeparator","detectorOptions","order","lookupQuerystring","lookupCookie","lookupLocalStorage","cookieMinutes","caches","excludeCacheFor","document","location","host","cookieDomain","mainDomain","cacheOptions","enabled","prefix","expirationTime","versions","detection","sendMissing","missingKeyHandler","miss","key","defaultValue","console","log","on","languageDetector","cacheUserLanguage","$","use","init","err","t","error","language","i18nName","localize","e","preventDefault","lang","data","changeLanguage","query","search","length","find","html","get","in30Minutes","set","expires","jQuery","authCookieName","loginClass","logoutClass","loginStatusInIndex","origin","mainLAUrl","pathname","isDevel","authCookie","domain","path","removeClass","addClass","checkExist","setInterval","clearInterval","addEventListener","inMante","manteDiv","show","module","exports","baseFooterUrl","theme","collectory","title","biocache","biocacheService","bie","regions","lists","spatial","images","cas","otherLinks","icon","CountUp","setCounter","id","val","onEnd","options","separator","duration","startVal","Math","round","countUp","start","getStats","callback","indexOf","count","totalRecords","total","getJSON","loadStats"],"mappings":"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","file":"public/js/app.js","sourcesContent":["var settings = require('./settings');\nvar bieService = settings.services.bieService.url;\n\n// Look for BC_CONF in ALA's public/js/application.js for more details\n// and options\n\nwindow.BC_CONF = window.BC_CONF || {};\nBC_CONF.autocompleteURL = `${bieService}/search/auto.json`\n","var settings = require('./settings');\nvar i18n = require('i18next');\nvar jqueryI18next = require('jquery-i18next');\nvar backend = require(\"i18next-http-backend\");\nvar lngDetector = require('i18next-browser-languagedetector');\nvar cache = require('i18next-localstorage-cache');\nvar Url = require('domurl');\nvar Cookies = require('js-cookie');\n\n// We use this backend as remote because subdomains.l-a.site should request to l-a.site domain\nconst backOpts = {\n  // Something like: https://vtatlasoflife.org/basic-brand-2020//locales/es/common\n  // More options: https://github.com/i18next/i18next-http-backend\n  loadPath: \"$_LOCALES_URL/locales/{{lng}}/{{ns}}\", // in the original .json\n\n  // allow cross domain requests\n  crossDomain: true,\n}\n\nvar currentUrl  = new Url;\n\nconst laSessionCookie = 'la-lang-session';\n\nconst i18nOpts = {\n  backend: backOpts,\n  //  lng: 'es',\n  fallbackLng: {\n    zh: ['en'],\n    \"sw-TZ\": ['en'],\n    default: ['en']\n  },\n  sendMissingTo: 'fallback',\n  interpolation: {\n    escapeValue: false,\n    formatSeparator: ',',\n    format: function f(value, format, lng) {\n      // https://www.i18next.com/formatting.html\n      // console.log(`Value: ${value} with format: ${format} to lang: ${lng}`);\n      if (format === 'uppercase') return value.toUpperCase();\n      if (value instanceof Date) return moment(value).format(format);\n      if (format === 'number') return Intl.NumberFormat(lng).format(value);\n      return value;\n    }\n  },\n  whitelist: settings.enabledLangs,\n  load: 'languageOnly', // 'es' o 'en', previously: 'all', // es-ES -> es, en-US -> en\n  debug: true,\n  ns: 'common',\n  defaultNS: 'common',\n  saveMissing: true, // if true seems it's fails to getResourceBundle\n  saveMissingTo: 'en',\n  keySeparator: 'ß',\n  nsSeparator: 'ð',\n  pluralSeparator: 'đ'\n};\n\nconst detectorOptions = {\n  // order and from where user language should be detected\n  order: ['querystring', 'cookie', 'navigator', 'localStorage', 'htmlTag'],\n\n  // keys or params to lookup language from\n  lookupQuerystring: 'lang',\n  lookupCookie: 'i18next',\n  lookupLocalStorage: 'i18nextLng',\n  cookieMinutes: 525600, // a year\n  // cache user language on\n  caches: ['cookie'],\n  excludeCacheFor: ['cimode'] // languages to not persist (cookie, localStorage)\n};\n\nif (document.location.host !== 'localhost:3333') {\n  // We set the upper domain in production so all ALA modules get the same locale\n  detectorOptions.cookieDomain = settings.mainDomain;\n}\n\nconst cacheOptions = {\n  // turn on or off\n  enabled: false,\n  // prefix for stored languages\n  prefix: 'i18next_res_',\n  // expiration\n  expirationTime: 7 * 24 * 60 * 60 * 1000,\n  // language versions\n  versions: {}\n};\n\ni18nOpts.cache = cacheOptions;\ni18nOpts.detection = detectorOptions;\n\ni18nOpts.sendMissing = false;\ni18nOpts.missingKeyHandler = function miss(lng, ns, key, defaultValue) {\n  // call to some API here\n  console.log(`\"${key}\": \"${defaultValue}\"`);\n};\n\ni18n.on('languageChanged', function (lng) {\n  if (i18n.services.languageDetector) {\n    console.log(`On lang changed ${lng}`);\n    // Store in the cookie the selection\n    i18n.services.languageDetector.cacheUserLanguage(lng);\n  }\n});\n\n(function($) {\ni18n.use(backend)\n    .use(lngDetector)\n    .use(cache)\n    .init(i18nOpts, (err, t) => {\n      // initialized and ready to\n      if (err) {\n        console.error(err);\n        return;\n      }\n      console.log(`Language initialized: ${i18n.language}`);\n      jqueryI18next.init(i18n, $, { i18nName: 'i18next' } );\n      console.log('jquery i18next initialized');\n      $(\"body\").localize();\n\n      $('.locale-link').on('click', function(e) {\n        e.preventDefault();\n        const lang = $(this).data('locale');\n        console.log(`Lang clicked ${lang}`);\n\n        i18n.changeLanguage(lang);\n\n        // Change ?lang param and reload\n        currentUrl.query.lang = lang;\n        document.location.search = currentUrl.query;\n      });\n      // used in clean theme\n      if( $('#dropdown-lang').length ) {\n        $('#dropdown-lang').find('.dropdown-toggle').html(i18n.language + ' <span class=\"caret\"></span>');\n      }\n\n      if (typeof Cookies.get(laSessionCookie) === 'undefined' && typeof currentUrl.query.lang === 'undefined') {\n        // Workaround to set grails locale\n        // This will use to do a unique lang redirect (to force grails to set the lang for the session)\n        var in30Minutes = 1/48;\n        // grails default session lifetime is 30min\n        Cookies.set(laSessionCookie, '/', { expires: in30Minutes });\n        currentUrl.query.lang = i18n.language;\n        document.location.search = currentUrl.query;\n      }\n\n      // cookies eu consent\n      /* const cookiesOpt = {\n       *   cookieTitle: t('Uso de Cookies'),\n       *   cookieMessage: t('Utilizamos cookies para asegurar un mejor uso de nuestra web. Si continúas navegando, consideramos que aceptas su uso'),\n       *   showLink: false,\n       *   position: 'bottom',\n       *   linkText: 'Lee más',\n       *   linkRouteName: '/privacy',\n       *   acceptButtonText: t('Aceptar'),\n       *   html: false,\n       *   expirationInDays: 70,\n       *   forceShow: false\n       * };\n       */\n      // CookieConsent.init(cookiesOpt);\n    });\n}(jQuery));\n","var Cookies = require(\"js-cookie\");\nconst settings = require(\"js/settings\");\nconst authCookieName = \"ALA-Auth\";\nconst loginClass = \"signedIn\";\nconst logoutClass = \"signedOut\";\n\nvar loginStatusInIndex = () => {\n  if (\n    (document.location.origin === settings.mainLAUrl ||\n      document.location.host === \"localhost:3333\") &&\n    document.location.pathname === \"/\"\n  ) {\n    if (settings.isDevel)\n      console.log(\"We are in the main url, let's see if we are authenticated\");\n    // As this page is plain html, we have to detect if with are authenticated via Cookies\n    // NOTE: For make this work you need ala.cookie.httpOnly to false in /data/cas/config/application.yml\n    // We should use another way to see if it's authenticated\n\n    let authCookie = Cookies.get(authCookieName, {\n      domain: settings.mainDomain,\n      path: \"/\",\n    });\n    var in30Minutes = 1 / 48;\n\n    if (\n      typeof authCookie === \"undefined\" &&\n      document.location.host === \"localhost:3333\"\n    ) {\n      console.log(\"We set a test cookie if we are in development\");\n      Cookies.set(authCookieName, \"/\", { expires: in30Minutes });\n    }\n\n    if (typeof authCookie !== \"undefined\") {\n      // https://github.com/AtlasOfLivingAustralia/ala-bootstrap3/blob/master/grails-app/taglib/au/org/ala/bootstrap3/HeaderFooterTagLib.groovy\n      if (settings.isDevel) console.log(\"Auth cookie present so logged in\");\n      $(\"#dropdown-auth-menu\")\n        .removeClass(\"::loginStatus::\")\n        .addClass(\"signedIn\");\n        $(\"#auth-header-buttons\")\n        .removeClass(\"::loginStatus::\")\n        .addClass(\"signedIn\");\n    } else {\n      if (settings.isDevel)\n        console.log(\"No auth cookie not present so not-logged in\");\n      $(\"#dropdown-auth-menu\")\n        .removeClass(\"::loginStatus::\")\n        .addClass(\"signedOut\");\n        $(\"#auth-header-buttons\")\n        .removeClass(\"::loginStatus::\")\n        .addClass(\"signedOut\");        \n    }\n  } else {\n    if (settings.isDevel) console.log(\"We aren't in the main url\");\n  }\n};\n\n$(function () {\n  // wait til drawer elements are visible\n  var checkExist = setInterval(function () {\n    if (window.jQuery && $(\"#dropdown-auth-menu\").length) {\n      clearInterval(checkExist);\n      loginStatusInIndex();\n    } else {\n      if (settings.isDevel) console.log(\"drawer not loaded\");\n    }\n  }, 1000);\n});\n","require('./settings.js').default;\nrequire('./index-auth.js');\nrequire('./i18next-config.js');\nrequire('./mante.js');\nrequire('./stats.js');\nrequire('./autocomplete-conf.js');\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  console.log('LA skin initialized');\n});\n","var settings = require('./settings');\n\n$(function(){\n  if (settings.inMante) {\n    console.log(\"Setting manteinance banner\");\n\n    var manteDiv = `<div class=\"row\">\n    <div class=\"col-md-6\">\n      <div class=\"error-template\">\n        <h1 data-i18n=\"error.title\"></h1>\n        <h2 data-i18n=\"error.subtitle\"></h2>\n        <div>\n          <p data-i18n=\"error.description\"></p>\n        </div>\n        <div class=\"error-actions\">\n          <a data-i18n=\"error.button\" href=\"${settings.mainLAUrl}\" style=\"margin-top: 10px;\" class=\"btn btn-primary btn-lg\"></a>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-md-6\">\n      <img src=\"images/error.svg\" alt=\"Error Image\" onerror=\"this.onerror=null; this.src='images/error.png'\">\n    </div>\n  </div>`;\n    $(\"#mante-container\").html(manteDiv);\n    $(\"#mante-container\").show();\n  }\n});\n","module.exports = {\n  isDevel: true,\n  inMante: false, // set to true and deploy if you want to set a maintenance message in all the services\n  enabledLangs: [\"en\"],\n  mainDomain: \"static.biodiversitydata.se\", // used for cookies (without http/https)\n  mainLAUrl: \"https://static.biodiversitydata.se\",\n  baseFooterUrl: \"https://static.biodiversitydata.se\",\n  theme: \"sbdi\", // for now 'material', 'sbdi' 'clean', 'superhero', 'yeti', 'cosmo', 'darkly', 'paper', 'sandstone', 'simplex', 'slate' or 'flatly' themes are available. See the last ones in: https://bootswatch.com/3/\n  services: {\n    collectory: { url: \"https://collections.biodiversitydata.se\", title: \"Collections\" },\n    biocache: { url: \"https://records.biodiversitydata.se\", title: \"Occurrence records\" },\n    biocacheService: {\n      url: \"https://records.biodiversitydata.se/ws\",\n      title: \"Occurrence records webservice\",\n    },\n    bie: { url: \"https://species.biodiversitydata.se\", title: \"Species\" },  \n    // This bieService var is used by the search autocomplete. With your BIE\n    // service running and well indexed, you can put here your url\n    bieService: {\n      url: \"https://species.biodiversitydata.se/ws\",\n      title: \"Species webservice\",\n    },\n    regions: { url: \"https://regions.biodiversitydata.se\", title: \"Regions\" },\n    lists: { url: \"https://lists.biodiversitydata.se\", title: \"Species List\" },\n    spatial: { url: \"https://spatial.biodiversitydata.se\", title: \"Spatial Portal\" },\n    images: { url: \"https://images.biodiversitydata.se\", title: \"Images Service\" },\n    cas: { url: \"https://auth.biodiversitydata.se\", title: \"CAS\" },\n  },\n  otherLinks: [\n    { title: \"Datasets\", url: \"https://collections.biodiversitydata.se/datasets\" },\n    {\n      title: \"Explore your area\",\n      url: \"http://records.biodiversitydata.se/explore/your-area/\",\n    },\n    { title: \"Datasets\", url: \"https://collections.biodiversitydata.se/datasets\" },\n    { title: \"twitter\", url: \"\", icon: \"twitter\" },\n  ],\n};\n","var settings = require('./settings');\n// FIXME var { locale } = require('./i18n_init');\nvar { CountUp } = require('countup.js');\n\nvar collectory = settings.services.collectory.url;\nvar biocacheService = settings.services.biocacheService.url;\n\n\nvar setCounter = (id, val, onEnd) => {\n  const options = {\n    separator: ',', // FIXME  locale === 'en' ? ',': '.',\n    duration: 1\n  };\n  // If testing set some dummy value\n  if (val === 0 && settings.isDevel) {\n    val = 123456;\n  }\n  options.startVal = Math.round(val - val * 4/100); // we increment only a %\n  console.log(`Start val ${options.startVal} to ${val}`);\n  const countUp = new CountUp(id, val, options);\n  if (!countUp.error) {\n    countUp.start(() => { $(`#${id}`).addClass('loaded_stats'); if (typeof onEnd !== 'undefined') onEnd(); });\n  } else {\n    console.error(countUp.error);\n  }\n};\n\nvar getStats = (url, callback) => {\n  if (settings.isDevel) {\n    if (url.indexOf('species') > -1) callback([{ count: 10402 }]);\n    else callback({ totalRecords: 86965283, total: 12922 });\n  } else {\n    // Real call in production\n    $.getJSON(url, callback);\n  }\n}\n\n// If you want to show collections stats:\n// `${collectory}/ws/dataResource/count`\nvar loadStats = () => {\n  getStats(`${biocacheService}/occurrences`, (data) => {\n    setCounter('stats_occurrences', data.totalRecords, () =>\n      getStats(`${collectory}/ws/dataResource/count`, (data) => {\n        setCounter('stats_datasets', data.total, () =>\n          getStats(`${collectory}/ws/institution/count`, (data) => {\n            setCounter('stats_institutions', data.total);\n          })\n        )\n      })\n    )});\n  // Right now this is slow so we put here\n  getStats(`${biocacheService}/occurrence/facets?q=*:*&facets=species&pageSize=0`, (data) => {\n    setCounter(\"stats_species\", data[0].count);\n  });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  if ((document.location.origin === settings.mainLAUrl || document.location.host === 'localhost:3333') && document.location.pathname === '/' ) {\n    // only load stats on /\n    loadStats();\n  }\n});\n"]}